<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>开放学校菜单管理系统</title>
		<link href="css/element-ui/2.2.1/theme-chalk/index.css" rel="stylesheet" />
	</head>
	<body>
		<div id="app">
		  	<el-form ref="form" :model="form" label-width="80px" :inline="true">
		  		<el-form-item>
		  			 <el-select v-model="schoolId" placeholder="请选择学校">
					    <el-option
					      v-for="school in schools"
					      :key="school.guid"
					      :label="school.name"
					      :value="school.guid">
					    </el-option>
					  </el-select>
		  		</el-form-item>
				<el-form-item>
				   <el-button type="primary" @click="search">搜索</el-button>
				</el-form-item>
				<el-form-item>
				   <el-button type="primary" @click="showFirstLevel">添加一级菜单</el-button>
				</el-form-item>
				<el-form-item>
					 <el-select v-model="apiPrefix" placeholder="配置环境" @change="changeEnvironment">
					    <el-option
					      v-for="env in environments"
					      :key="env.name"
					      :label="env.name"
					      :value="env.path">
					    </el-option>
					  </el-select>
				</el-form-item>
		  	</el-form>
		  	
			<el-tree :data="menus" node-key="id" ref="tree" :default-expand-all="expandAll" :expand-on-click-node="expandOnClickNode">
				<span class="custom-tree-node" slot-scope="{ node, data }">
				    <span>{{ node.label }}</span>
				    <span>
				      <el-button
				        type="text"
				        size="mini"
				        @click="() => showAppend(data)">
				        	添加
				      </el-button>
				    </span>
				    <span>
				      <el-button
				        type="text"
				        size="mini"
				        @click="() => showUpdateMenu(data,node)">
				        	修改
				      </el-button>
				    </span>
				    <span>
				      <el-button
				        type="text"
				        size="mini"
				        @click="() => deleteMenu(data)">
				        	删除
				      </el-button>
				    </span>
				    <span>
				      <el-button
				        type="text"
				        size="mini"
				        @click="() => rankDown(data,'UP')">
				        	上移
				      </el-button>
				    </span>
				    <span>
				      <el-button
				        type="text"
				        size="mini"
				        @click="() => rankDown(data,'DOWN')">
				        	下移
				      </el-button>
				    </span>
				</span>
			</el-tree>
		  
			<el-dialog title="添加子菜单" :visible.sync="addDialogVisible">
			  <el-form :model="form">
			    <el-form-item label="父菜单" :label-width="formLabelWidth">
			      <el-input v-model="form.parentName" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="子菜单名称" :label-width="formLabelWidth">
			      <el-input v-model="form.name" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="子菜单路径" :label-width="formLabelWidth">
			      <el-input v-model="form.path" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="子菜图标" :label-width="formLabelWidth">
			      <el-input v-model="form.icon" auto-complete="off"></el-input>
			    </el-form-item>
			  </el-form>
			  <div slot="footer" class="dialog-footer">
			    <el-button @click="addDialogVisible = false">取 消</el-button>
			    <el-button type="primary" @click="append">确 定</el-button>
			  </div>
			</el-dialog>
			
			<el-dialog title="添加一级菜单" :visible.sync="addFirstLevelDialogVisible">
			  <el-form :model="parentForm">
			    <el-form-item label="菜单名称" :label-width="formLabelWidth">
			      <el-input v-model="parentForm.name" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="菜单路径" :label-width="formLabelWidth">
			      <el-input v-model="parentForm.path" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="菜单图标" :label-width="formLabelWidth">
			      <el-input v-model="parentForm.icon" auto-complete="off"></el-input>
			    </el-form-item>
			  </el-form>
			  <div slot="footer" class="dialog-footer">
			    <el-button @click="addFirstLevelDialogVisible = false">取 消</el-button>
			    <el-button type="primary" @click="addFirstLevel">确 定</el-button>
			  </div>
			</el-dialog>
			
			<el-dialog title="修改菜单" :visible.sync="updateMenuVisible">
			  <el-form :model="updateForm">
			    <el-form-item label="菜单名称" :label-width="formLabelWidth">
			      <el-input v-model="updateForm.name" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="菜单路径" :label-width="formLabelWidth">
			      <el-input v-model="updateForm.path" auto-complete="off"></el-input>
			    </el-form-item>
			    <el-form-item label="菜单图标" :label-width="formLabelWidth">
			      <el-input v-model="updateForm.icon" auto-complete="off"></el-input>
			    </el-form-item>
			  </el-form>
			  <div slot="footer" class="dialog-footer">
			    <el-button @click="updateMenuVisible = false">取 消</el-button>
			    <el-button type="primary" @click="updateMenu">确 定</el-button>
			  </div>
			</el-dialog>
		</div>
		
	</body>
	
	
	<script src="js/vue.js"></script>
	<script src="js/axios.min.js"></script>
	<script src="js/index.js" ></script>
	<script src="js/jquery-1.8.0.js"></script>
	<script src="js/app.js"></script>
</html>
